{% extends 'main/base.html' %}

{% block title %}
Тема
{% endblock %}

{% block content %}
<h1 class="text-white">Тема и ответы к ней</h1>
{% if main_theme %}
<div class="alert-success alert mt-2">
    <p style="margin-left: 3%">Автор: {{main_theme.author_id}}</p>
    <h3>{{ main_theme.header }}</h3>
    <p>{{ main_theme.text }}</p>
    {% if main_theme.media %}
        <img src="{{ main_theme.media.url }}" alt="Медиа-вложение темы" width="300" height="300">
    {% endif %}
    <p>Дата создания темы: {{ main_theme.time_create }}</p>
</div>

{% if posts_related %}
{% for post in posts_related %}
<div class="alert-warning alert mt-2">
    <p style="margin-left: 3%">Автор: {{post.author_id}}</p>
    <h3>{{ post.theme }}</h3>
    <p>{{ post.text }}</p>
    {% if post.post_picture %}
        <img src="{{ post.post_picture.url }}" alt="Медиа-вложение поста" width="200" height="200">
    {% endif %}
    <p>Дата создания поста: {{ post.create_time }}</p>
</div>
{% endfor %}

{% else %}
<div class="alert-danger alert mt-2">
    <p>Тему ещё никто не комментировал</p>
</div>
{% endif %}

{% else %}
<div class="alert-danger alert mt-2">
    <p>Темы нет</p>
</div>
{% endif %}

<h1 class="text-white">Написать в тему</h1>
{% if request.user.is_authenticated %}
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.theme }} <br>
        {{ form.text }} <br>
        {{ form.post_picture }} <br>
        {{ form.captcha }}
        <p class="text-danger">{{ error }}</p>
        <button type="submit" class="btn btn-success mt-5">Запостить</button>
    </form>
{% else %}
    <p class="text-white">Комментировать тему могут только авторизованные ползователи</p>
{% endif %}
{% endblock %}